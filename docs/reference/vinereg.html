<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>D-vine regression models — vinereg • vinereg</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="D-vine regression models — vinereg" />

<meta property="og:description" content="Sequential estimation of a regression D-vine for the purpose of quantile
prediction as described in Kraus and Czado (2017). If discrete variables
are declared as ordered() or factor(), jittering is used
to make them continuous (see cctools::cont_conv()). Although this may
make the model estimate inconsistent, predictions are usually still reasonable." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vinereg</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/abalone-example.html">Example usage of the vinereg package</a>
    </li>
    <li>
      <a href="../articles/bike-rental.html">D-vine quantile regression with discrete variables: analysis of bike rental data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>D-vine regression models</h1>
    
    <div class="hidden name"><code>vinereg.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Sequential estimation of a regression D-vine for the purpose of quantile
prediction as described in Kraus and Czado (2017). If discrete variables
are declared as <code>ordered()</code> or <code>factor()</code>, jittering is used
to make them continuous (see <code><a href='http://www.rdocumentation.org/packages/cctools/topics/cont_conv'>cctools::cont_conv()</a></code>). Although this may
make the model estimate inconsistent, predictions are usually still reasonable.</p>
    
    </div>

    <pre class="usage"><span class='fu'>vinereg</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>family_set</span> <span class='kw'>=</span> <span class='st'>"parametric"</span>, <span class='kw'>selcrit</span> <span class='kw'>=</span> <span class='st'>"loglik"</span>,
  <span class='kw'>order</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>par_1d</span> <span class='kw'>=</span> <span class='fu'>list</span>(), <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>uscale</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>an object of class "formula"; same as <code>lm()</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>data frame (or object coercible by
<code>as.data.frame()</code>) containing the variables in the model.</p></td>
    </tr>
    <tr>
      <th>family_set</th>
      <td><p>see <code>family_set</code> argument of <code><a href='http://www.rdocumentation.org/packages/rvinecopulib/topics/bicop'>rvinecopulib::bicop()</a></code>.</p></td>
    </tr>
    <tr>
      <th>selcrit</th>
      <td><p>selection criterion based on conditional log-likelihood.
<code>"loglik"</code> (default) imposes no correction; other choices are
<code>"aic"</code> and <code>"bic"</code>.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>the order of covariates in the D-vine, provided as vector
of variable names (after calling <code><a href='http://www.rdocumentation.org/packages/cctools/topics/cont_conv'>cctools::cont_conv()</a></code> on the
<code>model.frame()</code>); selected automatically if <code>order = NA</code> (default).</p></td>
    </tr>
    <tr>
      <th>par_1d</th>
      <td><p>list of options passed to <code><a href='http://www.rdocumentation.org/packages/kde1d/topics/kde1d'>kde1d::kde1d()</a></code>, must be one value
for each margin, e.g. <code>list(xmin = c(0, 0, NaN))</code> if the response and
first covariate have non-negative support.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>integer; the number of cores to use for computations.</p></td>
    </tr>
    <tr>
      <th>uscale</th>
      <td><p>logical indicating whether the data are already on copula scale
(no margins have to be fitted).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to <code><a href='http://www.rdocumentation.org/packages/rvinecopulib/topics/bicop'>rvinecopulib::bicop()</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class vinereg. It is a list containing the elements</p><dl class='dl-horizontal'>
<dt>formula</dt><dd><p>the formula used for the fit.</p></dd>
<dt>selcrit</dt><dd><p>criterion used for variable selection.</p></dd>
<dt>model_frame</dt><dd><p>the data used to fit the regression model.</p></dd>
<dt>margins</dt><dd><p>list of marginal models fitted by <code><a href='http://www.rdocumentation.org/packages/kde1d/topics/kde1d'>kde1d::kde1d()</a></code>.</p></dd>
<dt>vine</dt><dd><p>an <code><a href='http://www.rdocumentation.org/packages/rvinecopulib/topics/vinecop'>rvinecopulib::vinecop_dist()</a></code> object containing the fitted
D-vine.</p></dd>
<dt>stats</dt><dd><p>fit statistics such as conditional log-likelihood/AIC/BIC and
p-values for each variable's contribution.</p></dd>
<dt>order</dt><dd><p>order of the covariates chosen by the variable selection algorithm.</p></dd>
<dt>selected_vars</dt><dd><p>indices of selected variables.</p></dd>
</dl><p>Use <code><a href='predict.vinereg.html'>predict.vinereg()</a></code> to predict conditional
quantiles. <code>summary.vinereg()</code> shows the contribution of each selected
variable with the associated p-value derived from a likelihood ratio test.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kraus and Czado (2017), D-vine copula based quantile regression,
Computational Statistics and Data Analysis, 110, 1-18</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict.vinereg.html'>predict.vinereg</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># simulate data</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>rnorm</span>(<span class='fl'>300</span>), <span class='fl'>100</span>, <span class='fl'>2</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> <span class='kw'>%*%</span> <span class='fu'>c</span>(<span class='fl'>1</span>, -<span class='fl'>2</span>)
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>y</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fu'>as.factor</span>(<span class='fu'>rbinom</span>(<span class='fl'>100</span>, <span class='fl'>2</span>, <span class='fl'>0.5</span>)))

<span class='co'># fit vine regression model</span>
(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>vinereg</span>(<span class='no'>y</span> ~ <span class='no'>.</span>, <span class='no'>dat</span>))</div><div class='output co'>#&gt; D-vine regression model: y | x.2, x.1, z.1, z.2 
#&gt; nobs = 100, edf = 30.24, cll = -6.71, caic = 73.9, cbic = 152.68 </div><div class='input'>
<span class='co'># inspect model</span>
<span class='fu'>summary</span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt;   var      edf          cll       caic       cbic      p_value
#&gt; 1   y 13.24142 -220.6242023  467.73125  502.22741           NA
#&gt; 2 x.2  2.00000   88.1504436 -172.30089 -167.09055 5.208933e-39
#&gt; 3 x.1  3.00000  124.9348097 -243.86962 -236.05411 6.982744e-54
#&gt; 4 z.1  6.00000    0.2069543   11.58609   27.21711 9.987341e-01
#&gt; 5 z.2  6.00000    0.6247217   10.75056   26.38158 9.743722e-01</div><div class='input'><span class='fu'><a href='plot_effects.html'>plot_effects</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; <span class='message'>`geom_smooth()` using method = 'loess' and formula 'y ~ x'</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at -0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.01</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at -0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.01</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at -0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 1.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  0</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.01</span></div><div class='output co'>#&gt; <span class='warning'>Warning: at  -0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: radius  2.5e-05</span></div><div class='output co'>#&gt; <span class='warning'>Warning: all data on boundary of neighborhood. make span bigger</span></div><div class='output co'>#&gt; <span class='warning'>Warning: pseudoinverse used at -0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: neighborhood radius 0.005</span></div><div class='output co'>#&gt; <span class='warning'>Warning: reciprocal condition number  1</span></div><div class='output co'>#&gt; <span class='warning'>Warning: There are other near singularities as well. 1.01</span></div><div class='output co'>#&gt; <span class='warning'>Warning: zero-width neighborhood. make span bigger</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Computation failed in `stat_smooth()`:</span>
#&gt; <span class='warning'>NA/NaN/Inf in foreign function call (arg 5)</span></div><div class='img'><img src='vinereg-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># model predictions</span>
<span class='no'>mu_hat</span>  <span class='kw'>&lt;-</span> <span class='fu'>predict</span>(<span class='no'>fit</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>NA</span>)          <span class='co'># mean</span>
<span class='no'>med_hat</span> <span class='kw'>&lt;-</span> <span class='fu'>predict</span>(<span class='no'>fit</span>, <span class='kw'>newdata</span> <span class='kw'>=</span> <span class='no'>dat</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)         <span class='co'># median</span>

<span class='co'># observed vs predicted</span>
<span class='fu'>plot</span>(<span class='fu'>cbind</span>(<span class='no'>y</span>, <span class='no'>mu_hat</span>))</div><div class='img'><img src='vinereg-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## fixed variable order (no selection)</span>
(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>vinereg</span>(<span class='no'>y</span> ~ <span class='no'>.</span>, <span class='no'>dat</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"x.2"</span>, <span class='st'>"x.1"</span>, <span class='st'>"z.1"</span>)))</div><div class='output co'>#&gt; D-vine regression model: y | x.2, x.1, z.1 
#&gt; nobs = 100, edf = 22.24, cll = -5.88, caic = 56.25, cbic = 114.19 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas Nagler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

